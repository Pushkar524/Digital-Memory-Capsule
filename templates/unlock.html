{% extends "layout.html" %}
{% block content %}
  <section class="card">
    <div class="row">
      <div>
        <h2>Capsule #{{ capsule.id }}</h2>
        <p class="muted">Unlocked at: {{ capsule.unlock_time }}</p>
      </div>
      <a class="link" href="{{ url_for('index') }}">Back</a>
    </div>
    <form class="form" method="post" action="{{ url_for('unlock', capsule_id=capsule.id) }}">
      <label>
        Your key half (base64)
        <input type="text" name="user_key_half" placeholder="Paste your key half" required />
      </label>
      <button type="submit">Unlock</button>
    </form>
    {% if capsule.message %}
      <p class="message-box">{{ capsule.message }}</p>
    {% endif %}
  </section>

  {% if capsule.files %}
    <section class="card">
      <h3>Files</h3>
      <ul class="list">
        {% for file in capsule.files %}
          <li class="row">
            <div>
              <span class="mono">{{ file.filename }}</span>
              <span class="muted"> ({{ file.size }} bytes)</span>
            </div>
            <a class="link" href="{{ url_for('download_file', file_id=file.id) }}">Download</a>
          </li>
        {% endfor %}
      </ul>
    </section>
  {% endif %}
{% endblock %}
